
<!DOCTYPE html>
<html>
<head>
  <title>pyworxcloud Collector</title>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: auto; }
    button { padding: 10px; margin-top: 10px; }
  </style>
</head>
<body>
<h1>pyworxcloud Collector</h1>

<p>Credentials are used only for this active capture session.</p>

<input id="email" placeholder="Email"><br>
<input id="password" type="password" placeholder="Password"><br>
<label><input type="checkbox" id="consent"> I consent</label><br>

<button onclick="start()">Start Capture</button>
<button onclick="stop()">Stop Capture</button>
<button onclick="download()">Download ZIP</button>

<pre id="out"></pre>

<script>
let sid = null;

async function start() {
  const res = await fetch("/api/sessions/start", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      email: email.value,
      password: password.value,
      hours: 2
    })
  });
  const j = await res.json();
  sid = j.session_id;
  out.innerText = JSON.stringify(j, null, 2);
}

async function stop() {
  await fetch(`/api/sessions/${sid}/stop`, {method: "POST"});
  out.innerText = "Stopped";
}

async function download() {
  const r = await fetch(`/api/sessions/${sid}/download`);
  out.innerText = await r.text();
}
</script>
</body>
</html>
